# 蒙特卡洛方法求解二重积分

这是作业一练习三的Python实现，使用蒙特卡洛方法来计算二重积分 ∫₀¹ ∫₀¹ e^(-(x²+y²)) dx dy。

## 文件说明

- `monte_carlo_double_integration.py`: 主要的Python代码文件
- `requirements.txt`: 所需的Python包依赖
- `README.md`: 说明文档

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行代码

```bash
python monte_carlo_double_integration.py
```

## 功能特点

1. **蒙特卡洛二重积分**: 使用均匀分布采样计算 ∫₀¹ ∫₀¹ e^(-(x²+y²)) dx dy
2. **多N值测试**: 测试N = 10, 20, 30, 40, 50, 60, 70, 80, 100, 200, 500的情况
3. **统计分析**: 对每个N值重复100次实验，计算均值和方差
4. **解析解计算**: 使用scipy计算积分的解析解进行对比
5. **采样方法比较**: 比较均匀分布采样和重要性采样的效果
6. **可视化展示**: 
   - 3D函数图：显示函数曲面和采样点
   - 等高线图：显示函数等高线和采样点分布
   - 收敛分析：不同N值下的收敛情况
   - 误差分析：绝对误差和相对误差
   - 方差分析：方差随N的变化
   - 采样分布：采样点的分布情况
7. **结果保存**: 将结果保存为CSV文件和PNG图片

## 输出文件

- `monte_carlo_double_integration_results.csv`: 包含所有N值的统计结果
- `monte_carlo_double_integration_visualization.png`: 可视化图片

## 理论背景

### 积分问题
计算二重积分：∫₀¹ ∫₀¹ e^(-(x²+y²)) dx dy

### 解析解
由于积分可以分离变量：
∫₀¹ ∫₀¹ e^(-(x²+y²)) dx dy = ∫₀¹ e^(-x²) dx × ∫₀¹ e^(-y²) dy = (∫₀¹ e^(-x²) dx)²

使用高斯误差函数：
∫₀¹ e^(-x²) dx = (√π/2) × erf(1)

### 蒙特卡洛方法
1. **均匀分布采样**: 在[0,1]×[0,1]区域内均匀采样N个点(x_i, y_i)
2. **函数值计算**: 计算f(x_i, y_i) = e^(-(x_i²+y_i²))
3. **积分估计**: I ≈ (1/N) × Σ f(x_i, y_i)

### 采样分布选择
- **均匀分布**: 最简单的方法，在[0,1]×[0,1]上均匀采样
- **重要性采样**: 使用与函数形状相似的分布进行采样

### 收敛性
对于二重积分，蒙特卡洛方法的收敛速度仍然是O(1/√N)，但随着维度的增加，需要的采样点数会更多。

## 结果分析

程序会输出：
1. 不同N值下的积分估计值、方差、标准差
2. 绝对误差和相对误差
3. 解析解与蒙特卡洛估计的对比
4. 不同采样方法的比较
5. 可视化图表展示：
   - 3D函数曲面
   - 等高线图
   - 收敛过程
   - 误差分析

## 技术特点

- 使用scipy计算解析解进行验证
- 3D可视化展示函数形状
- 多种采样方法的比较
- 详细的误差和方差分析
- 对数坐标显示收敛趋势

