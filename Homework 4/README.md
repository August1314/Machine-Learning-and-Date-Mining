# Homework 4: 支持向量机(SVM)分类器

## 项目概述

本项目从零实现了支持向量机(SVM)分类器，使用随机梯度下降(SGD)算法训练模型，对Adult Income数据集进行二分类任务。

**目标**: 预测个人年收入是否超过$50K

**重要**: 本实现**不使用**sklearn等预构建的SVM库，完全手动实现算法。

## 文件说明

```
Homework 4/
├── svm_classifier.py              # 主程序（包含所有实现）
├── train.txt                      # 训练数据（43,957样本）
├── test.txt                       # 测试数据（4,885样本）
├── results_summary.txt            # 结果摘要文件
├── regularization_analysis.png    # 正则化分析图表
└── README.md                      # 本文件
```

## 依赖环境

需要以下Python库：

```bash
pip install numpy matplotlib
```

或使用conda：

```bash
conda install numpy matplotlib
```

## 运行方法

直接运行主程序：

```bash
python svm_classifier.py
```

程序将自动执行以下步骤：

1. **数据加载和预处理**
   - 加载训练和测试数据
   - 特征编码（分类特征 → 数值）
   - 特征标准化（Z-score）
   - 标签转换（"<=50K" → -1, ">50K" → +1）

2. **正则化分析**
   - 测试4个不同的λ值：[0.001, 0.01, 0.1, 1.0]
   - 对每个λ值训练独立的SVM模型
   - 记录测试准确率

3. **结果输出**
   - 打印所有λ值的准确率
   - 生成结果摘要文件
   - 生成可视化图表

4. **最终模型训练**
   - 使用最佳λ值训练最终模型
   - 在测试集上进行预测

## 实验结果

### 正则化分析结果

| λ值   | 测试准确率 |
|-------|-----------|
| 0.001 | **82.18%** |
| 0.010 | 81.84%    |
| 0.100 | 79.57%    |
| 1.000 | 77.12%    |

**最佳λ值**: 0.001（准确率82.18%）

### 关键发现

1. **λ较小(0.001)**
   - 正则化惩罚较弱
   - 模型更复杂，能更好地拟合数据
   - 在本实验中获得最高准确率

2. **λ适中(0.01-0.1)**
   - 在模型复杂度和泛化能力之间平衡
   - 准确率略有下降但仍然良好

3. **λ较大(1.0)**
   - 正则化惩罚较强
   - 模型过于简单，可能欠拟合
   - 准确率明显下降

## 算法说明

### SVM模型

**决策函数**: f(x) = sign(w^T x + b)

**损失函数**: Hinge Loss + L2正则化

### 梯度公式（按作业要求）

对于每个样本(x_k, y_k)：

**权重梯度**:
```
∇_w = λw                    如果 y_k(w^T x_k + b) ≥ 1
∇_w = λw - y_k x_k          否则
```

**偏置梯度**:
```
∇_b = 0                     如果 y_k(w^T x_k + b) ≥ 1
∇_b = -y_k                  否则
```

### SGD更新规则

```
w := w - η * ∇_w
b := b - η * ∇_b
```

其中η是学习率（本实验使用0.001）

## 数据集说明

### Adult Income数据集

**来源**: UCI Machine Learning Repository

**特征** (14个):
- 数值特征: age, fnlwgt, education-num, capital-gain, capital-loss, hours-per-week
- 分类特征: workclass, education, marital-status, occupation, relationship, race, sex, native-country

**标签**:
- "<=50K": 年收入不超过50K美元
- ">50K": 年收入超过50K美元

**数据分布**:
- 训练集: 43,957样本（>50K: 10,492, <=50K: 33,465）
- 测试集: 4,885样本（无标签）

## 实现细节

### 数据预处理

1. **分类特征编码**
   - 使用标签编码(Label Encoding)
   - 为每个分类特征维护映射字典
   - 处理测试集中未见过的类别

2. **数值特征标准化**
   - 使用Z-score标准化: x' = (x - μ) / σ
   - 在训练集上计算μ和σ
   - 使用相同参数标准化测试集

3. **缺失值处理**
   - 检测"?"作为缺失值标记
   - 映射为特殊类别"MISSING"

### 训练参数

- **学习率**: 0.001
- **训练轮数**: 50 epochs
- **正则化常数**: [0.001, 0.01, 0.1, 1.0]
- **初始化**: 权重和偏置初始化为0

### 性能优化

- 使用NumPy向量化操作
- 每个epoch随机打乱样本顺序
- 每10个epoch打印训练进度

## 输出文件

### 1. results_summary.txt

包含：
- 数据集信息
- 所有λ值的准确率
- 详细的正则化分析说明

### 2. regularization_analysis.png

可视化图表，展示：
- λ值（对数刻度）vs 测试准确率
- 每个点标注准确率数值
- 清晰的趋势线

## 作业要求对照

✅ **要求1**: SVM关键概念和实现方法说明
   - 见代码开头的文档字符串

✅ **要求2**: 测试准确率截图
   - 程序运行时打印清晰的准确率

✅ **要求3**: 正则化分析
   - 测试λ = [1e-3, 1e-2, 1e-1, 1]
   - 列出每个λ值的准确率
   - 提供详细解释

✅ **要求4**: 代码截图
   - 代码结构清晰，注释完整

✅ **要求5**: 完整代码
   - svm_classifier.py包含所有实现

## 注意事项

1. **运行时间**: 程序需要几分钟完成（训练4个模型）
2. **随机性**: 设置了随机种子(42)以确保结果可重复
3. **内存**: 数据集较大，需要足够内存
4. **中文支持**: 图表和输出支持中文显示

## 技术亮点

1. ✨ **完全手动实现**: 不依赖sklearn等机器学习库
2. ✨ **严格遵循公式**: 按照作业提供的梯度公式实现
3. ✨ **完整的数据预处理**: 处理分类特征、缺失值、标准化
4. ✨ **可视化分析**: 生成专业的分析图表
5. ✨ **详细文档**: 代码注释完整，输出清晰

## 作者信息

- **课程**: 机器学习与数据挖掘
- **作业**: Homework 4 - Support Vector Machine
- **讲师**: Shangsong Liang
- **学校**: 中山大学

---

**注意**: 请勿分发本文档和相关数据集
