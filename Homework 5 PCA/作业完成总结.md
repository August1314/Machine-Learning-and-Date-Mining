# Homework 5 PCA 作业完成总结

**学生姓名**: 梁力航  
**学号**: 23336128  
**完成日期**: 2025年10月27日

---

## ✅ 完成状态

### 所有要求已完成

✅ **问题(a)**: 主成分维度 - 已回答（10101）  
✅ **问题(b)**: PC1 vs PC2散点图 - 已生成  
✅ **问题(c)**: 解释PC1和PC2 - 已回答（地理和历史）  
✅ **问题(d)**: PC1 vs PC3散点图 - 已生成（两个版本）  
✅ **问题(e)**: 解释PC3 - 已回答（性别信息）  
✅ **问题(f)**: PC3值分布图和解释 - 已生成和回答（染色体结构）  
✅ **问题(g)**: 方差解释比例和讨论 - 已回答  
✅ **代码**: 完整代码在pca_genome_analysis.py  
✅ **实验报告**: 完整的实验报告.md

---

## 📊 实验结果摘要

### 数据统计

- **个体数量**: 995
- **核苷酸位点**: 10101
- **性别分布**: 509男, 486女
- **种群数量**: 7个不同种群
- **突变率**: 39.24%

### 主要发现

#### 问题(a): 主成分维度
**答案**: 10101

#### 问题(b): PC1 vs PC2散点图
见图表: `results/pc1_pc2_scatter.png`

#### 问题(c): PC1和PC2的解释
- 不同种群在PC1-PC2空间中形成明显的聚类
- 前两个主成分捕捉了人类种群的地理起源和迁移历史
- 反映了非洲、欧洲和亚洲种群之间的遗传差异

#### 问题(d): PC1 vs PC3散点图
见图表: 
- `results/pc1_pc3_scatter_sex.png` (按性别)
- `results/pc1_pc3_scatter_pop.png` (按种群)

性别标签能更好地解释PC3的聚类模式。

#### 问题(e): PC3捕捉的信息
**答案**: 第三主成分主要捕捉了性别信息，反映了X和Y染色体之间的遗传差异。

#### 问题(f): PC3值分布
见图表: `results/pc3_values.png`

**观察**: PC3的绝对值在某些区域明显较高，呈现出分段的模式。

**解释**: 这种模式反映了染色体结构，特别是性染色体（X和Y）上的变异。峰值区域对应于Y染色体特有的序列区域。

#### 问题(g): 方差解释比例

| 主成分 | 解释方差 | 平方长度减少 |
|--------|----------|--------------|
| PC1    | 0.57%    | 99.43%       |
| 前3个PC | 1.41%    | 98.59%       |

**讨论**: 
- 基因组数据具有极高的维度，前3个主成分只解释了约1.41%的方差
- 尽管如此，前几个主成分仍然捕捉到了最重要的变异模式（地理起源、性别等）
- 大部分方差来自于个体之间的细微差异和噪声
- 对于可视化和理解主要的遗传结构，前几个主成分已经足够有用

---

## 📁 提交文件清单

### 必需文件

1. **实验报告.md** (约25KB)
   - 完整的实验报告（Markdown格式）
   - 包含所有7个问题的详细回答
   - 可以转换为PDF提交

2. **pca_genome_analysis.py** (约15KB)
   - 完整的源代码
   - 包含详细注释
   - 可直接运行

3. **图表文件** (results/目录)
   - `pc1_pc2_scatter.png` (889KB)
   - `pc1_pc3_scatter_sex.png` (575KB)
   - `pc1_pc3_scatter_pop.png` (886KB)
   - `pc3_values.png` (332KB)

4. **analysis_results.txt** (3.2KB)
   - 所有问题的文本答案

### 辅助文件

5. **README.md** (约8KB)
   - 项目说明文档
   - 运行方法
   - 结果解释

---

## 🎯 作业要求对照

| 要求 | 状态 | 说明 |
|------|------|------|
| 问题(a) | ✅ | 主成分维度: 10101 |
| 问题(b) | ✅ | PC1 vs PC2散点图（按种群着色，含图例） |
| 问题(c) | ✅ | 1-2句话描述基本事实，解释PC1和PC2 |
| 问题(d) | ✅ | PC1 vs PC3散点图（两个版本，含图例） |
| 问题(e) | ✅ | 一句话说明PC3捕捉的信息 |
| 问题(f) | ✅ | PC3值分布图，观察和解释 |
| 问题(g) | ✅ | 方差解释比例，1-2句话讨论 |
| 代码 | ✅ | 完整代码在附录/单独文件 |

---

## 💡 技术亮点

1. ✨ **完整的数据预处理流程**: 从原始核苷酸序列到二值矩阵
2. ✨ **标准PCA实现**: 使用sklearn，符合作业要求
3. ✨ **多角度可视化**: 不同标签方案的对比分析
4. ✨ **详细的生物学解释**: 结合遗传学知识解释结果
5. ✨ **清晰的代码结构**: 模块化设计，易于理解
6. ✨ **高质量图表**: 300 DPI，清晰的标签和图例

---

## 📝 运行说明

### 环境要求

```bash
conda activate ml
```

或安装依赖：

```bash
pip install numpy pandas matplotlib scikit-learn scipy
```

### 运行程序

```bash
cd "Homework 5 PCA"
python pca_genome_analysis.py
```

### 预期输出

程序将：
1. 加载995个个体的基因组数据
2. 转换为二值矩阵
3. 执行PCA分析
4. 回答所有7个问题
5. 生成4个图表
6. 保存结果到results/目录

运行时间：约10-30秒

---

## 🎓 学习收获

通过完成本次作业，我：

1. **深入理解了PCA**: 掌握了主成分分析的原理和应用
2. **学习了基因组数据分析**: 了解如何处理和分析大规模基因组数据
3. **理解了生物信息学概念**: 遗传变异、种群结构、染色体组织等
4. **提升了数据可视化能力**: 学会如何有效地可视化高维数据
5. **培养了科学思维**: 学会从数据中提取有意义的生物学结论

---

## 📚 参考资料

- International Genome Sample Resource: https://www.internationalgenome.org/
- Scikit-learn PCA文档: https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html
- 原始作业: https://web.stanford.edu/class/cs168/p4.pdf

---

**完成状态**: ✅ 全部完成  
**代码状态**: ✅ 测试通过  
**文档状态**: ✅ 完整详细  
**提交准备**: ✅ 就绪
