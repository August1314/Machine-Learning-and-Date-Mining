# 需求文档

## 简介

本项目从零开始实现支持向量机（SVM）分类器，使用随机梯度下降（SGD）对Adult Income数据集进行二分类任务。目标是根据人口普查数据特征预测个人年收入是否超过$50K。实现必须**不使用预构建的SVM包**（如sklearn的SVM），需要手动实现SVM算法，以展示对底层数学和优化技术的理解。

数据集说明：
- `train.txt`: 包含43,957条带标签的训练数据
- `test.txt`: 包含4,885条无标签的测试数据
- 标签: "<=50K" 或 ">50K"
- 数据来源: UCI Adult数据集

## 需求

### 需求 1: 数据加载和预处理

**用户故事:** 作为机器学习实践者，我想加载和预处理Adult Income数据集，以便数据适合训练SVM分类器。

#### 验收标准

1. WHEN 程序启动 THEN 系统应从`Homework 4/train.txt`加载训练数据（43,957个样本）和从`Homework 4/test.txt`加载测试数据（4,885个样本）
2. WHEN 加载数据 THEN 系统应从特征中排除第一列（年龄，作业要求说是ID但实际是年龄，需要保留作为特征）
3. WHEN 解析数据 THEN 系统应正确识别数值特征和分类特征
4. WHEN 预处理分类特征 THEN 系统应将其编码为数值表示（如one-hot编码或标签编码）
5. WHEN 预处理数值特征 THEN 系统应对其进行归一化/标准化以确保一致的尺度
6. WHEN 编码标签 THEN 系统应将"<=50K"转换为-1，将">50K"转换为+1以兼容SVM
7. IF 特征包含缺失值（例如"?"） THEN 系统应适当处理它们（使用众数/均值插补或删除）
8. WHEN 预处理完成 THEN 系统应将训练集和测试集转换为numpy数组格式

### 需求 2: 使用SGD从零实现SVM

**用户故事:** 作为学生，我想从零开始使用随机梯度下降实现SVM训练，以便理解SVM优化的数学基础，并满足作业"不使用预构建包"的要求。

#### 验收标准

1. WHEN 实现SVM THEN 系统应使用带L2正则化的hinge损失函数
2. WHEN 计算梯度 THEN 系统应严格按照作业提供的梯度公式实现：
   - ∇_a = λa 如果 y_k(a^T x_k + b) ≥ 1，否则 λa - y_k x_k
   - ∇_b = 0 如果 y_k(a^T x_k + b) ≥ 1，否则 -y_k
3. WHEN 使用SGD训练 THEN 系统应在每次迭代中随机选择一个样本进行梯度更新
4. WHEN 更新参数 THEN 系统应使用可配置的学习率η（需要根据作业提示调整）
5. WHEN 训练 THEN 系统应支持可配置的正则化常数λ
6. WHEN 初始化参数 THEN 系统应将权重向量a和偏置b初始化为零或小随机值
7. WHEN 训练 THEN 系统应支持设置训练轮数（epochs）
8. WHEN 训练完成 THEN 系统应返回学习到的权重向量(a)和偏置项(b)
9. WHEN 实现代码 THEN 系统不应使用sklearn.svm或其他预构建的SVM实现

### 需求 3: 模型评估和测试

**用户故事:** 作为研究人员，我想在测试数据上评估训练好的SVM，以便衡量模型的泛化性能并满足作业提交要求。

#### 验收标准

1. WHEN 进行预测 THEN 系统应为每个测试样本计算sign(a^T x + b)
2. WHEN 计算预测 THEN 系统应将sign函数的输出转换为-1或+1
3. WHEN 进行预测 THEN 系统应计算并报告测试准确率（百分比形式）
4. WHEN 显示结果 THEN 系统应以清晰的格式将准确率打印到控制台（用于截图）
5. WHEN 打印结果 THEN 系统应显示格式如"Test Accuracy: XX.XX%"
6. WHEN 评估完成 THEN 系统应将结果保存到`Homework 4`目录

### 需求 4: 正则化常数分析（作业要求3）

**用户故事:** 作为数据科学家，我想使用不同的正则化常数训练SVM模型并比较它们的性能，以便理解正则化对模型准确率的影响，并完成作业要求的分析。

#### 验收标准

1. WHEN 进行正则化分析 THEN 系统应使用λ值训练SVM模型：[1e-3, 1e-2, 1e-1, 1]（作业明确要求）
2. WHEN 使用每个λ值训练 THEN 系统应记录相应的测试准确率
3. WHEN 分析完成 THEN 系统应显示表格或列表，清晰列出每个λ值及其对应的准确率
4. WHEN 呈现结果 THEN 系统应生成文本说明，解释准确率如何随正则化强度变化
5. WHEN 生成解释 THEN 系统应说明为什么准确率会有这样的趋势（正则化的作用）
6. WHEN 分析完成 THEN 系统应将结果表格保存到`Homework 4`目录
7. IF 生成可视化图表 THEN 系统应将图表保存到`Homework 4`目录

### 需求 5: 代码文档和作业提交输出

**用户故事:** 作为提交作业的学生，我想要有良好文档的代码和清晰的输出，以便实现易于理解并满足作业提交的所有要求。

#### 验收标准

1. WHEN 编写代码 THEN 系统应包含中文或英文注释解释关键实现步骤
2. WHEN 编写代码 THEN 系统应在代码开头包含SVM关键概念和实现方法的说明（满足作业要求1）
3. WHEN 程序运行 THEN 系统应在训练期间打印进度信息（如epoch数、当前损失等）
4. WHEN 显示测试准确率 THEN 系统应以清晰格式打印，便于截图（满足作业要求2）
5. WHEN 进行正则化分析 THEN 系统应打印每个λ值的准确率列表（满足作业要求3）
6. WHEN 生成结果 THEN 系统应将所有输出文件保存到`Homework 4`目录
7. WHEN 程序完成 THEN 系统应生成包含所有结果的摘要文件
8. WHEN 代码编写完成 THEN 系统应确保代码结构清晰，便于截图展示（满足作业要求4）
9. WHEN 所有功能完成 THEN 系统应确保代码可以直接运行并生成所有要求的输出

### 需求 6: 输出文件要求

**用户故事:** 作为学生，我想要程序生成所有必需的输出文件，以便完成作业提交。

#### 验收标准

1. WHEN 程序运行 THEN 系统应在`Homework 4`目录下生成Python源代码文件
2. WHEN 正则化分析完成 THEN 系统应生成包含λ值和准确率对比的结果文件
3. WHEN 生成结果 THEN 系统应创建一个摘要文本文件，包含所有关键结果
4. IF 生成可视化 THEN 系统应保存准确率vs正则化常数的图表
5. WHEN 所有输出生成 THEN 系统应确保文件名清晰易识别
